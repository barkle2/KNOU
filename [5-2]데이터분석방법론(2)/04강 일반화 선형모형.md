# 제4강 일반화 선형모형

학습목표
1. 범주형 자료분석에서 통계모형 적용의 필요성에 대해 설명할 수 있다.
  - 단순한 유의성 검정이 나닌 모수 추정을 통해서 더 많은 정보를 얻을 수 있다.
2. 일반화선형모형(GLM)의 구성요소를 설명할 수 있다.
3. 이항자료와 도수자료에 대한 일반화선형모형을 설명할 수 있다.

## 1. GLM의 성분

### 1. GLM의 성분 구성요소

- GLM(Generalized Linear Model)
  - 여러 설명변수들의 효과를 동시에 분석해야 하는 복잡한 상황에 유용함
    ⇒ 모형을 이용한 분석에는 모수 추정에 역점을 두며, 단순한 유의성 검정보다 더 많은 정보 제공
  - 범주형 및 연속형 반응변수에 대해서는 잘 알려진 통계모형들을 포괗하는 일반화된 형태의 통계모형
  - 회귀모형, ANOVA 모형, 로지스틱회귀모형 등은 GLM의 특별한 경우임

### 2. GLM
- GLM
  - 전통적인 휘귀모형을 반응변수가 정규분포를 따르지 않는 경우로 확장한 것임
- GLM을 적용하기 위해서는 반응변수가 지수족 분포(Exponential Family of Distributions)를 따라야만 함

- 모든 GLM의 세 가지 공통 요소
  - 랜덤 성분(Random Component)
  - 체계적 성분(Systematic Component)
  - 연결 함수(Link Function)

### 3. GLM의 구성요소

#### 1. 랜덤 성분(Random Component)

- 반응변수 Y를 결정
- <img src="https://latex.codecogs.com/svg.image?Y_1,Y_2,\cdots,Y_n">을 정규분포, 포아송분포, 이항분포 등에서 추출된 랜덤 표본으로 가정
- <img src="https://latex.codecogs.com/svg.image?\mu_i=E(Y_i)">가 설명변수들에 의해서 어떻게 영향을 받는지 모형 설정
- Exponential Family 분포
  <img src="https://latex.codecogs.com/svg.image?f(y_i;\theta_i)=a(\theta_i)b(y_i)\cdot exp[y_iQ(\theta_i)]">
  - 예: Poisson 분포
  <img src="https://latex.codecogs.com/svg.image?f(y_i;\mu)=\frac{e^{\mu}\mu^{y}}{y!}=exp(-\mu)(\frac{1}{y!})\cdot exp[y(log\mu)],\;\;\;y=0,1,2,\cdots">

#### 2. 체계적 성분(Systematic Component)

- 설명변수 <img src="https://latex.codecogs.com/svg.image?\{x_i\}">의 선형식인 선형예측식(Linear Predictor)으로 구성
  <img src="https://latex.codecogs.com/svg.image?\alpha+\beta_1x_1+\beta_2x_2+\cdots+\beta_kx_k">

#### 3. 연결함수(Link Function)
- Y에 대한 기댓값 <img src="https://latex.codecogs.com/svg.image?\mu=E(Y)">는 설명변수들의 값에 따라 달라짐
- 랜덤성분과 체계적 성분(선형예측식)을 연결하는 함수 g(·)를 말함
  <img src="https://latex.codecogs.com/svg.image?g(\mu)=\alpha+\beta_1x_1+\beta_2x_2+\cdots+\beta_kx_k">

- 연결함수의 예
  - *g(μ)=μ* : 항등연결(identity Link)
    - 반응변수가 정규분포를 따를 때 회귀분석(Ordinary Regression)에 해당함
  - *g(μ)=log(μ)* : 로그연결
    - 평균의 로그를 모형화하는 것으로 빈도와 같이 기대값이 음이 아닌 자료에 적합
    - 로그연결을 사용하는 GLM을 로그선형모형(Loglinear Model)이라고 함
  - <img src="https://latex.codecogs.com/svg.image?g(\mu)=log\left( \frac{\mu}{1-\mu}\right)">: 로짓연결(Logit Link)
    - 이항분포(μ=π 이고, 0<π<1)의 경우에 주로 사용
    - logit = log of odds
  - 표준연결함수(Canonical Link)
    - Exponential Family 분포
    <img src="https://latex.codecogs.com/svg.image?f(y_i;\theta_i)=a(\theta_i)b(y_i)\cdot exp[y_iQ(\theta_i)]">
      - Canonical Link: <img src="https://latex.codecogs.com/svg.image?g(\mu_i)=Q(\mu_i)">
      예:   <img src="https://latex.codecogs.com/svg.image?f(y_i;\mu)=\frac{e^{\mu}\mu^{y}}{y!}=exp(-\mu)(\frac{1}{y!})\cdot exp[y(log\mu)],\;\;\;y=0,1,2,\cdots">
      <img src="https://latex.codecogs.com/svg.image?g(\mu)=log(\mu) \rightarrow log(\mu_i)=\sum_{j}\beta_j x_{ij},\;\;\;i=1,2,\cdots,n">

#### Note1
- GLM은 보통의 회귀분석을 다음의 두 가지 관점에서 일반화한 것으로 볼 수 있음
  ① Y에 대하여 정규분포 이외에 다른 확률분포를 허용함
  ② 단순한 μ에 대한 모형화가 아닌 μ의 함수인 g(μ)에 대한 모형화가 가능함

#### Note2
- GLM의 모수추정 과정에서는 선택된 랜덤성분에 대하여 ML(최대가능도 추정법) 방법을 사용
- 랜덤성분의 확률분포로 정규분포 이외의 분포도 가능함
- 회귀모형, 분산분석 모형, 범주형 자료에 대한 모형들은 GLM의 특별한 경우
- 동일 ML추정법을 사용하여 모든 GLM에 대한 모형 적합이 가능함

## 2. 이항자료에 대한 일반화 선형모형

## 3. 도수자료에 대한 일반화 선형모형: 포아송 회귀

<img src="https://latex.codecogs.com/svg.image?\{x_i\}">
<img src="https://latex.codecogs.com/svg.image?\{x_i\}">

