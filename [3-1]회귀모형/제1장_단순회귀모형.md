## 머리말

- 회귀분석: 반응변수(=종속변수)와 설명변수(=독립변수) 간의 함수관계를 규명하는 통계적인 분석방법
  - 회귀모형을 적합하고, 적합된 모형을 통해서 설명변수가 반응변수에 미치는 영향을 살피고, 반응변수의 값을 추정한다.
  - 최적모형을 적합하기 위해서는 모형의 가정, 모형의 적합, 모형의 진단이라는 과정을 끊임없이 반복해야 한다.

## 1.1 회귀분석이란?
- 독립변수(=설명변수)들과 종속변수(=반응변수) 간의 함수관계를 규명하는 통계적인 분석방법
  - 독립변수: 다른 변수에 영향을 주는 변수
  - 종속변수: 독립변수에 의하여 영향을 받는 변수

## 1.2 단순회귀모형

### 1.2.1 산점도

- 두 변수 간의 함수관계를 밝히기 위한 첫 단계는 두 변수 간의 산점도(scatterplot)을 그려보는 것
  - 산점도: 한 변수를 x축으로 놓고, 다른 변수를 y축으로 그린 그래프

### 1.2.2 단순회귀모형
- 설명변수 X와 반응변수 Y의 관계가 직선의 형태를 가지는 경우에 우리는 두 변수 간의 적합모형을 다음과 같이 쓸 수 있다.
$$Y_i = \beta _0 + \beta_1 X_i + \varepsilon _i$$

$Y_i$ : i번째 측정된 반응변수 Y의 값<br>
$\beta_0$: 절편 회귀계수<br>
$\beta_1$: 기울기 회귀계수<br>
$X_i$: i번째 주어진 상수 X값<br>
$\epsilon_i$: i번째 측정된 Y의 오차항으로 평균 $E(\epsilon_i)=0$, 분산 $Var(\epsilon_i)=\sigma^2$ 이면서, 다른 오차항과는 상관관계가 없는 것으로 가정<br>

- 단순회귀모형에서 우리는 다음과 같은 사실을 알 수 있다.
  - ① 반응변수 $Y_i$는 상수항 $\beta_0+\beta_1 X_i$와 오차항 $\epsilon_i$로 이루어져 있으며, 따라서 $Y_i$는 확률변수이다.
  - ② 오차항의 평균 $E(\epsilon_i)=0$이므로, $$E(Y_i) = E(\beta _0 + \beta_1 X_i + \varepsilon _i)=\beta_0+\beta_1 X_i+E(\epsilon_i)=\beta_0+\beta_1 X_i$$ 이다. 주어진 X에서 Y의 기댓값을 $\mu_{Y\cdot X}=\beta_0+\beta_1 X$라고 하면 $$Y=\mu_{Y\cdot X}+\epsilon$$ 으로 표현된다.
  - ③ 오차항 $\epsilon_i$의 분산은 등분산(homoscedastic) $\sigma^2$로 가정한다. 따라서 반응변수 $Y_i$의 분산은 $$Var(Y_i)=Var(\beta_0+\beta_1 X_i+\epsilon_i)=Var(\epsilon_i)=\sigma^2$$ 이므로, 반응변수 $Y_i$도 등분산 $\sigma^2$을 갖는다. 
  - ④ 반응변수 Y의 오차항들은 서로 독립적이라고 가정한다. 두 변수 간의 공분산(covariance) $$Cov(\epsilon_i, \epsilon_j)=0, \quad (i\neq j)$$ 이 성립되는 가정이다.

## 1.3 회귀선의 추정

### 1.3.1 최소제곱법

- 최소제곱법은 $$Y_i=\beta_0+\beta_1 X_i+\epsilon_i$$ 에서 오차제곱들의 합 $$S=\sum_{i=1}^{n}(Y_i-\beta_0-\beta_1 X_i)^2$$을 최소로 하는 $\beta_0$와 $\beta_1$의 값들을 이들의 추정값 $b_0$와 $b_1$으로 하는 방법이다.
- 이를 구하기 위해서는 오차제곱합 S를 $\beta_0$와 $\beta_1$으로 각각 편미분하여 이를 0으로 하여 구하면 된다.

### 1.3.2 잔차

- 적합된 회귀직선 $\hat{Y}=b_0 +b_1 X$ 에서 X 대신에 i번째 X의 값 $X_i$를 사용하면 $$\hat{Y_i}=b_0+b_1 X_i$$ 가 되는데, 여기서 $\hat Y_i$는 $X_i에서의 기댓값 $E(Y_i)$의 추정값이다.
- $X_i$에서 측정된 값 $Y_i$와 추정된 $\hat{Y_i}$와의 차이 $$e_i = Y_i - \hat{Y_i}$$를 잔차라고 부른다.

## 1.4 회귀모형의 정도

- 추정된 회귀선이 얼마나 잘 추정했는지 판단하는 측도
  - ① 분산분석표에 의한 F-검정
  - ② 결정계수
  - ③ 추정값의 표준오차
  
### 1.4.1 분산분석표에 의한 F-검정

- 하나의 관찰값 $Y_i$와 평균 $\bar{Y}$와의 편차는 다음과 같이 둘로 나눌 수 있다.
$$(Y_i-\bar{Y})=(Y_i-\hat{Y_i})+(\hat{Y_i}-\bar{Y})$$
  - 여기서 $(Y_i-\bar{Y})$를 총편차라고 하고,
  - $(Y_i-\hat{Y_i})$는 잔차로서 회귀선에 의하여 설명되지 않는 편차이고,
  - $(\hat{Y_i}-\bar{Y})$는 회귀선에 의하여 설명되는 편차이다.

- 총편차의 제곱의 합은 다음과 같이 두 변동의 합으로 분해가 된다.
$$\sum_{i=1}^n (Y_i-\bar{Y})^2
= \sum_{i=1}^n ({Y}_i-\hat{Y_i})^2
+ \sum_{i=1}^n (\hat{Y_i}-\bar{Y})^2$$
  - 총편차 제곱의 합을 총변동(total variation) 또는 총제곱합(total sum of squares)라고 부르며 SST 로 표시한다.
  $$SST=\sum_{i=1}^n (Y_i-\bar{Y})^2$$
  - 잔차에 의한 제곱합(sum of squares due to residual errors)를 SSE 라고 하며, 회귀에 의한 제곱합(sum of squares due to regression)은 SSR 이라 한다.
  $$SSE=\sum_{i=1}^n ({Y}_i-\hat{Y_i})^2$$
  $$SSR=\sum_{i=1}^n (\hat{Y_i}-\bar{Y})^2$$
- SST, SSE, SSR 의 자유도는 각각 n-1, n-2, 1 이 된다.

- 주어진 자료를 적합시키는데 회귀직선이 유의한가는 분산분석표를 통해 확인한다.<br>

[단순회귀의 분산분석표]

|요인|자유도|제곱합|평균제곱|$F_0$|
|:-:|:-:|:-:|:-:|:-:|
|회귀|1|SSR|MSR=SSR|$\displaystyle{\frac{MSR}{MSE}}$|
|잔차|n-2|SSE|$\displaystyle{MSE=\frac{SSE}{n-2}}$||
|계|n-1|SST|||

- 대립가설이 옳으면 회귀직선이 주어진 자료를 적합하는데 유의하다는 의미이다. 
- 대립가설이 옳으면 회귀제곱합의 평균이 잔차제곱합의 평균보다 커지게 되어(즉, MSR > MSE)가 되어 $F_0$의 값이 커질 것이다.
- 검정통계량 $F_0$의 값이 커질수록 유의확률 p-값이 작아지는데, p-값이 유의수준 $\alpha$ 보다 작으면$(p값<\alpha)$ 귀무가설을 기각한다.